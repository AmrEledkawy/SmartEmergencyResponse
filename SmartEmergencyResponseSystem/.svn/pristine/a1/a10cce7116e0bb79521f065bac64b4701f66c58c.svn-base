classdef Kuka < Vehicle
    %% Haptics Device, few details available at this time
    properties (Access = private)
        % Configurable properties to be agreed on with Bluhaptics
        
        %GPSipAddress = '172.28.208.200'
        GPSipAddress = '127.0.0.1';
        GPSportNumber = 9527;
        
        %sensoripAddress = '172.28.208.200'
        sensoripAddress = '127.0.0.1';
        sensorPortNumber = 9528;
        
        % Other properties
        GPS
        sensors
        datagramListener
    end
    
    methods
        function obj = Kuka
            obj = obj@Vehicle(0,[-122.4,37.8]); % Random Id and location for the vehicle
            
            % Using GPS and Sensor for Biobot as of now, change when Kuka
            % team sends the specs
            obj.GPS = GPSConnection(obj.GPSipAddress,obj.GPSportNumber);
            obj.sensors = SensorConnection(obj.sensoripAddress,obj.sensorPortNumber);
            
            obj.datagramListener = addlistener(obj.GPS,'validDatagramReceived',@obj.unpackDatagram);
        end
        
        function delete(obj)
            delete(obj.datagramListener);
            delete(obj.GPS);
            delete(obj.sensors);
        end
    end
    
    methods (Access = private)
        function unpackDatagram(obj,~,~)
            obj.location = [obj.GPS.lastValidData.latitude obj.GPS.lastValidData.longitude];
        end
    end
end

